Lemma 4.5 implies F\_{0}(\alpha,\beta)=d(\alpha,\beta)=n, and Lemma 4.3 implies F\_{0}(\gamma\_{j+1},\gamma\_{j})=1. So

|  |  |  |  |
| --- | --- | --- | --- |
|  | \displaystyle F(\beta,\gamma\_{j+1}) | \displaystyle=\left|{F\_{0}(\beta,\eta)-F\_{0}(\gamma\_{j+1},\eta)}\right| |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | \displaystyle=\left|{F\_{0}(\eta,\alpha)+F\_{0}(\alpha,\beta)-F\_{0}(\eta,\gamma\_% {j})+F\_{0}(\gamma\_{j+1},\gamma\_{j})}\right| |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | \displaystyle=\left|{F\_{0}(\eta,\alpha)+n-(F\_{0}(\eta,\alpha)+F\_{0}(\alpha,% \gamma\_{j}))+1)}\right| |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | \displaystyle=n-j+1. |  |

Hence, d(\beta,\gamma\_{j+1})\geq F(\beta,\gamma\_{j+1})=n-j+1. But recall that (\gamma\_{0}=\alpha,\gamma\_{1},\dots,\gamma\_{n}=\beta) is geodesic path between \alpha and \beta. In particular, d(\beta,\gamma\_{j+1})=n-(j+1)=n-j-1. So we have a contradiction.
∎

###### Lemma 4.7.

Let \alpha and \beta be disjoint separating curves such that [\alpha,\beta] is full. If \alpha(\eta,\lambda) is a lasso curve adjacent to \alpha in \Gamma, and \alpha(\eta,\lambda) is not contained in [\alpha,\beta], then d(\alpha(\eta,\lambda),\beta)\geq d(\alpha,\beta).

###### Proof.

We prove the contrapositive statement. Let n=d(\alpha,\beta) and suppose d(\alpha(\eta,\lambda),\beta)<n. Since \alpha(\eta,\lambda) and \alpha are neighbors in \Gamma, we must have d(\alpha(\eta,\lambda),\beta)=n-1. Take a geodesic path of length n-1 between \alpha(\eta,\lambda) and \beta, and include (the edge between \alpha(\eta,\lambda) and) \alpha and to obtain a path of length n between \alpha and \beta. Then this is a geodesic path between \alpha and \beta which contains \alpha(\eta,\lambda). By Lemma 4.6, \alpha(\eta,\lambda) is contained in [\alpha,\beta].
∎

The above lemma is reminiscent of Lemma 3.6, but crucially, it is not as powerful because it requires \alpha and \beta to be disjoint. Lastly, we define the notions of flux-right and flux-left in the exact same way as in the previous section, and the statements and proofs of Lemma 3.20 all still hold in the more general setting.

### 4.3. Hamming distance

In the previous case of the bi-infinite flute, one of the tools we used was the operation of forgetting a puncture. However, it does not seem to be easy to extend this idea to the more general setting. How does one precisely define “forgetting a discrete-type end” or “forgetting a genus” as operations which map separating curves to separating curves? Thus, to compensate for the absence of this tool, we introduce another pseudometric on \Gamma which provides a better lower bound on d than flux does. For a subsurface T\subset\Sigma, denote by {\mathrm{End}}\_{d}(T) the subset of discrete-type ends in {\mathrm{End}}(T). For each separating curve \alpha, put P(\alpha)={\mathrm{End}}\_{d}(\alpha\_{+}).

###### Definition 4.8.

The Hamming distance between separating curves \alpha and \beta, denoted by H(\alpha,\beta), is defined by

|  |  |  |
| --- | --- | --- |
|  | H(\alpha,\beta)=\left|{P(\alpha)\triangle P(\beta)}\right|+g(\alpha,\beta). |  |

To get some intuition behind this definition, suppose that S has zero or infinite genus, so that g(\alpha,\beta) is always 0. Each separating curve \alpha partitions the set of discrete-type ends of \Sigma, which is identified with \mathbb{Z}, into two sets, thereby associating to \alpha a bi-infinite binary sequence which stabilizes at 0 in one direction and at 1 in the other direction. Then H(\alpha,\beta)=\left|{P(\alpha)\triangle P(\beta)}\right| is equal to the classical Hamming distance between the two sequences associated to \alpha and \beta.

###### Lemma 4.9.

For all separating curves \alpha and \beta, if d(\alpha,\beta)=1 then H(\alpha,\beta)=1.

###### Proof.

By definition, d(\alpha,\beta)=1 means that \alpha and \beta are disjoint and [\alpha,\beta] is homeomorphic to some T\in\mathcal{S}. If T=T\_{i} for some i=1,\dots,n, then T has exactly one discrete-type end f and its genus is either 0 or infinite. Assuming \alpha lies on the left side of \beta, this means that P(\alpha)=P(\beta)\sqcup\left\{{f}\right\}. So P(\alpha)\triangle P(\beta)=\left\{{f}\right\} and g\_{0}(\alpha,\beta)=0. If T=T\_{n+1}, then T has no discrete-type ends and its genus is 1. So P(\alpha)=P(\beta) and g\_{0}(\alpha,\beta)=1. In either case, H(\alpha,\beta)=1.
∎

Moreover, H is indeed a pseudometric.

###### Lemma 4.10.

For all separating curves \alpha,\beta,\gamma in \Sigma, we have H(\alpha,\beta)\leq H(\alpha,\gamma)+H(\gamma,\beta).

###### Proof.

It suffices to show that the inequality holds separately for \left|{P(\alpha)\triangle P(\beta)}\right| and g(\alpha,\beta).
Indeed,