|  |  |  |
| --- | --- | --- |
|  | \cE\_{1}(\bar{\kappa};\beta,\tilde{\nu}\_{n})\lesssim\tau+\sqrt{d}\,\|\beta-% \beta\_{m}\|\_{\tv}, |  |

and, applying 6, we obtain

|  |  |  |
| --- | --- | --- |
|  | \cE\_{1}(\bar{\kappa}\circ\proj\_{S};\alpha,\tilde{\nu}\_{n})\lesssim\tau+\sqrt{d% }\,\|\beta-\beta\_{m}\|\_{\tv}+\sqrt{d}\,\sigma. |  |

Now, write \mu^{\prime}\_{n}\in\cP(\R^{d}) for an intermediate measure such that \|\mu^{\prime}\_{n}-\tilde{\mu}\_{n}\|\_{\tv}\leq\eps and \Wp(\mu^{\prime}\_{n},\hat{\mu}\_{n})\leq\rho. Noting that \alpha=N^{\sigma}\_{\sharp}\tilde{\mu}\_{n}, we have by Fact 3 that \|\alpha-N^{\sigma}\_{\sharp}\mu^{\prime}\_{n}\|\_{\tv}\leq\eps. Thus, 5 gives

|  |  |  |
| --- | --- | --- |
|  | \cE\_{1}(\bar{\kappa}\circ\proj\_{S};N^{\sigma}\_{\sharp}\mu^{\prime}\_{n},\tilde{% \nu}\_{n})\lesssim\sqrt{d}\eps+\tau+\sqrt{d}\,\|\beta-\beta\_{m}\|\_{\tv}+\sqrt{d% }\,\sigma. |  |

Applying 6 once more, we obtain

|  |  |  |
| --- | --- | --- |
|  | \cE\_{1}(\bar{\kappa}\circ\proj\_{S}\circ N^{\sigma/2};N^{\sigma/2}\_{\sharp}\mu^% {\prime}\_{n},\tilde{\nu}\_{n})\lesssim\sqrt{d}\eps+\tau+\sqrt{d}\,\|\beta-\beta% \_{m}\|\_{\tv}+\sqrt{d}\,\sigma. |  |

By 14, the fact that this latest kernel begins with the convolution N^{\sigma/2} ensures that it is O(\sqrt{d}\sigma^{-1})-Lipschitz w.r.t. \Wone. Moreover, by Fact 4, we have \Wone(N^{\sigma/2}\_{\sharp}\mu^{\prime}\_{n},N^{\sigma/2}\_{\sharp}\hat{\mu}\_{n}%
)\leq\Wone(\mu^{\prime}\_{n},\hat{\mu}\_{n})\leq\rho. Thus, 4 gives

|  |  |  |
| --- | --- | --- |
|  | \cE\_{1}(\bar{\kappa}\circ\proj\_{S}\circ N^{\sigma/2};N^{\sigma/2}\_{\sharp}\hat% {\mu}\_{n},\tilde{\nu}\_{n})\lesssim\sqrt{d}\eps+\tau+\sqrt{d}\,\|\beta-\beta\_{m% }\|\_{\tv}+\sqrt{d}\,\sigma+\rho+\frac{\sqrt{d}\,\rho}{\sigma}. |  |

Next, we apply 5 and 6 to bound

|  |  |  |  |
| --- | --- | --- | --- |
|  |  | \displaystyle\cE\_{1}(\bar{\kappa}\circ\proj\_{S}\circ N^{\sigma};\mu,\tilde{\nu% }\_{n}) |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | \displaystyle\lesssim\, | \displaystyle\cE\_{1}(\bar{\kappa}\circ\proj\_{S}\circ N^{\sigma/2};N^{\sigma/2}% \_{\sharp}\mu,\tilde{\nu}\_{n})+\sqrt{d}\,\sigma |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | \displaystyle\lesssim\, | \displaystyle\cE\_{1}(\bar{\kappa}\circ\proj\_{S}\circ N^{\sigma/2};N^{\sigma/2}% \_{\sharp}\hat{\mu}\_{n},\tilde{\nu}\_{n})+\sqrt{d}\,\sigma+\sqrt{d}\,\|N^{\sigma% /2}(\mu-\hat{\mu}\_{n})\|\_{\tv} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | \displaystyle\lesssim\, | \displaystyle\sqrt{d}\,\eps+\tau+\sqrt{d}\,\sigma+\rho+\frac{\sqrt{d}\,\rho}{% \sigma}+\sqrt{d}\,\|\beta-\beta\_{m}\|\_{\tv}+\sqrt{d}\,\|N^{\sigma/2}(\mu-\hat{% \mu}\_{n})\|\_{\tv}. |  |

Finally, we correct the target measure, using 3 to bound

|  |  |  |
| --- | --- | --- |
|  | \displaystyle\invisequals\cE\_{1}(\bar{\kappa}\circ\proj\_{S}\circ N^{\sigma};% \mu,\nu)\leq\cE\_{1}(\bar{\kappa}\circ\proj\_{S}\circ N^{\sigma};\mu,\tilde{\nu}% \_{n})+2\Wp(\tilde{\nu}\_{n},\nu) |  |
|  |  |  |
| --- | --- | --- |
|  | \displaystyle\lesssim\sqrt{d}\,\eps+\tau+\sqrt{d}\,\sigma+\rho+\frac{\sqrt{d}% \,\rho}{\sigma}+\sqrt{d}\,\|\beta-\beta\_{m}\|\_{\tv}+\sqrt{d}\,\|N^{\sigma/2}(% \mu-\hat{\mu}\_{n})\|\_{\tv}+\Wp(\hat{\nu}\_{n},\nu) |  |

Taking expectations, using our early bound on the first TV distance, and applying 13 for the second TV distance, and applying 1 for the Wasserstein distance, we obtain

|  |  |  |  |
| --- | --- | --- | --- |
|  |  | \displaystyle\E[\cE\_{1}(\bar{\kappa}\circ\proj\_{S}\circ N^{\sigma};\mu,\nu)] |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | \displaystyle\lesssim\, | \displaystyle\sqrt{d}\,\eps+\tau+\sqrt{d}\,\sigma+\rho+\frac{\sqrt{d}\,\rho}{% \sigma}+\sqrt{\frac{dn}{m}}+\sqrt{d\,3^{d}(1\lor\sigma^{-d})/n}+c\_{p,d}n^{-% \frac{1}{p\lor 2d}}\log^{2}n |  |

Our choice of \sigma, m, and \tau ensure that the desired risk bound holds.

Computational complexity is dominated by the OT computation at Step 3. The source and target distributions are both supported on n points, and we require accuracy \tau=n^{-1/(d+2)}. Computing the relevant cost matrix requires time O(n^{2}d). Using a state of the art OT solver based on entropic OT (e.g., Luo et al., 2023) gives a running time of O(C\_{\infty}n^{2}/\tau)=O(C\_{\infty}n^{2+1/(d+2)}), where C\_{\infty} is the largest distance between a point in S and a point in T. Combining these two gives the first bound. Evaluation complexity is dominated by the projection step, which can be computed in a brute-force manner using O(nd) time.