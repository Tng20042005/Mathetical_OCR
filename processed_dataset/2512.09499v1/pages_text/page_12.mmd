{X},\kappa\_{X^{\prime}})^{p}\right] |  |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  |  | \displaystyle\leq\E\left[L^{p}\|X-X^{\prime}\|^{\alpha p}\right] |  | (Hölder continuity of \kappa) |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  |  | \displaystyle\leq L^{p}\E\left[L\|X-X^{\prime}\|^{p}\right]^{\alpha} |  | (Jensen’s inequality, 0<\alpha\leq 1) |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | \displaystyle=L^{p}\rho^{\alpha p}. |  |

Moreover, using Minkoswki’s inequality, we compute

|  |  |  |
| --- | --- | --- |
|  | \displaystyle\bigl{|}\E[\|Y-X\|^{p}]^{\frac{1}{p}}-\E[\|Y^{\prime}-X^{\prime}% \|^{p}]^{\frac{1}{p}}\bigr{|}\leq\E[\|X-X^{\prime}\|^{p}]^{\frac{1}{p}}+\E[\|Y% -Y^{\prime}\|^{p}]^{\frac{1}{p}}\leq\rho+L\rho^{\alpha}. |  |

Finally, we bound |\Wp(\mu,\nu)-\Wp(\mu^{\prime},\nu)|\leq\Wp(\mu,\mu^{\prime})\leq\rho and

|  |  |  |
| --- | --- | --- |
|  | \displaystyle|\Wp(\kappa\_{\sharp}\mu,\nu)-\Wp(\kappa\_{\sharp}\mu^{\prime},\nu)% |\leq\Wp(\kappa\_{\sharp}\mu,\kappa\_{\sharp}\mu^{\prime})\leq\E[\|Y-Y^{\prime}% \|^{p}]^{\frac{1}{p}}\leq L\rho^{\alpha}. |  |

The definition of \cE\_{p} and these bounds give the lemma.∎

### A.6 Proof of 5

To show this result, we prove a slightly more general lemma.

###### Lemma 7.

Fix \mu,\mu^{\prime}\in\cP(\cX), \nu\in\cP(\cY), and kernel \kappa\in\cK(\cX,\cY) with \iint\|y-x\|^{p}\dd\kappa\_{x}(y)\dd\mu(x)\leq\Wp(\mu,\kappa\_{\sharp}\mu)^{p}+%
\tau^{p} and \Wp(\kappa\_{\sharp}\mu,\nu)\leq\tau for some \tau\geq 0. Then, setting \eps=\|\mu-\mu^{\prime}\|\_{\tv}, we have \cE\_{p}(\kappa;\mu^{\prime},\nu)\leq 3\diam(\cY)\eps^{1/p}+3\tau.

###### Proof.

In what follows, we encourage the reader to focus on the p=1 case, where computations are more direct. Write \eps=\|\mu-\mu^{\prime}\|\_{\tv}. By the TV bound, there exist \alpha,\beta,\gamma\in\cM\_{+}(\cX) with \gamma(\cX)=1-\eps and \alpha(\cX)=\beta(\cX)=\eps such that \mu=\gamma+\alpha and \mu^{\prime}=\gamma+\beta.

First, we note that \kappa must perform well on \gamma. Specifically, we have

|  |  |  |  |
| --- | --- | --- | --- |
|  | \displaystyle\iint\|x | \displaystyle-y\|^{p}\dd\kappa\_{x}(y)\dd\gamma(x) |  |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  |  | \displaystyle=\iint\|x-y\|^{p}\dd\kappa\_{x}(y)\dd\mu(x)-\iint\|x-y\|^{p}\dd% \kappa\_{x}(y)\dd\alpha(x) |  | (\gamma=\mu-\alpha) |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  |  | \displaystyle\leq\Wp(\mu,\kappa\_{\sharp}\mu)^{p}+\tau^{p}-\Wp(\alpha,\kappa\_{% \sharp}\alpha)^{p} |  | (error bound for \kappa, def. of \Wp) |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  |  | \displaystyle\leq\Wp(\gamma,\kappa\_{\sharp}\gamma)^{p}+\Wp(\alpha,\kappa\_{% \sharp}\alpha)^{p}+\tau^{p}-\Wp(\alpha,\kappa\_{\sharp}\alpha)^{p} |  | (\mu=\gamma+\alpha) |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | \displaystyle=\Wp(\gamma,\kappa\_{\sharp}\gamma)^{p}+\tau^{p} |  |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  |  | \displaystyle\leq\left(\Wp(\gamma,\kappa\_{\sharp}\gamma)+\tau\right)^{p}. |  | (\ell\_{p}\leq\ell\_{1}) |

Now, letting \kappa^{\prime} be an optimal kernel for the \Wp(\mu^{\prime},\nu) problem and writing D=\diam(\cY), we have

|  |  |  |  |
| --- | --- | --- | --- |
|  |  | \displaystyle\left(\iint\|y-x\|^{p}\dd\kappa\_{x}(y)\dd\mu^{\prime}(x)\right)^{% \frac{1}{p}}-\Wp(\mu^{\prime},\nu) |  |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  | \displaystyle=\, | \displaystyle\left(\iint\|y-x\|^{p}\dd\kappa\_{x}(y)\dd\mu^{\prime}(x)\right)^{% \frac{1}{p}}-\left(\iint\|y-x\|^{p}\dd\kappa^{\prime}\_{x}(y)\dd\mu^{\prime}(x)% \right)^{\frac{1}{p}} |  | (optimality of \kappa^{\prime}) |
|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  | \displaystyle=\, | \displaystyle\left(\iint\|y-x\|^{p}\dd\kappa\_{x}(y)\dd\gamma(x)+\iint\|y-x\|^{% p}\dd\kappa\_{x}(y)\dd\beta(x)\right)^{\frac{1}{p}} |  | (\mu^{\prime}=\gamma+\beta) |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | \displaystyle-\left(\iint\|y-x\|^{p}\dd\kappa^{\prime}\_{x}(y)\dd\gamma(x)+% \iint\|y-x\|^{p}\dd\kappa^{\prime}\_{x}(y)\dd\beta(x)\right)^{\frac{1}{p}} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | \displaystyle\leq\, | \displaystyle\Bigg{(}\left[\left(\iint\|y-x\|^{p}\dd\kappa\_{x}(y)\dd\gamma(x)% \right)^{\!\frac{1}{p}}-\left(\iint\|y-x\|^{p}\dd\kappa^{\prime}\_{x}(y)\dd% \gamma(x)\right)^{\!\frac{1}{p}}\right]\_{+}^{\!p} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | \displaystyle+\left[\left(\iint\|y-x\|^{p}\dd\kappa\_{x}(y)\dd\beta(x)\right)^{% \!\frac{1}{p}}-\left(\iint\|y-x\|^{p}\dd\kappa^{\prime}\_{x}(y)\dd\beta(x)% \right)^{\!\frac{1}{p}}\right]\_{+}^{\!p}\,\,\Bigg{)}^{\frac{1}{p}} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | \displaystyle\leq\, | \displaystyle\Bigg{(}\left[\Wp(\gamma,\kappa\_{\sharp}\gamma)+\tau-\Wp(\gamma,% \kappa^{\prime}\_{\sharp}\gamma)\right]\_{+}^{p} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | \displaystyle+\left[\left(\iint\|y-x\|^{p}\dd\kappa\_{x}(y)\dd\beta(x)\right)^{% \!\frac{1}{p}}-\left(\iint\|y-x\|^{p}\dd\kappa^{\prime}\_{x}(y)\dd\beta(x)% \right)^