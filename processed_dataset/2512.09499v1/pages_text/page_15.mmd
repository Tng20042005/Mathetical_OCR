|  |  |  |  |
| --- | --- | --- | --- |
|  | \displaystyle\tau | \displaystyle=\cE\_{p}(\kappa;\mu,\nu)\lor\left[2^{p-1}p\cE\_{p}(\kappa;\mu,\nu)% \Wp(\mu,\nu)^{p-1}+3^{p}2^{p-1}p\cE\_{p}(\kappa;\mu,\nu)^{p}\right]^{\frac{1}{p}} |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  |  | \displaystyle\leq 3\cE\_{p}(\kappa;\mu,\nu)^{\frac{1}{p}}\Wp(\mu,\nu)^{\frac{p-% 1}{p}}+7\cE\_{p}(\kappa;\mu,\nu) |  |

Plugging into 7 gives that

|  |  |  |
| --- | --- | --- |
|  | \cE\_{p}(\kappa;\mu^{\prime},\nu)\leq 3D\eps^{1/p}+9\cE\_{p}(\kappa;\mu,\nu)^{% \frac{1}{p}}\Wp(\mu,\nu)^{\frac{p-1}{p}}+21\cE\_{p}(\kappa;\mu,\nu), |  |

as desired. The p=1 result is immediate.∎

### A.7 Proof of 6

First, we note that \kappa\_{\sharp}(\lambda\_{\sharp}\mu)=(\kappa\circ\lambda)\_{\sharp}\mu by the definition of kernel composition. This implies that the two feasibility gaps coincide. Moreover, by Minkowski’s inequality, we have

|  |  |  |  |
| --- | --- | --- | --- |
|  |  | \displaystyle\left|\left(\iint\|y-z\|^{p}\dd\kappa\_{z}(y)\dd(\lambda\_{\sharp}% \mu)(z)\right)^{\frac{1}{p}}-\left(\iint\|y-x\|^{p}\dd(\kappa\circ\lambda)\_{x}% (y)\dd\mu(x)\right)^{\frac{1}{p}}\right| |  |
|  |  |  |  |
| --- | --- | --- | --- |
|  | \displaystyle\leq\, | \displaystyle\left(\iint\|z-x\|^{p}\dd\lambda\_{x}(z)\dd\mu(x)\right)^{\frac{1}% {p}} |  |

and

|  |  |  |
| --- | --- | --- |
|  | \displaystyle\left|\Wp(\lambda\_{\sharp}\mu,\nu)-\Wp(\mu,\nu)\right|\leq\Wp(\mu% ,\lambda\_{\sharp}\mu)\leq\left(\iint\|z-x\|^{p}\dd\lambda\_{x}(z)\dd\mu(x)% \right)^{\frac{1}{p}}. |  |

Combining these two error bounds gives the lemma.∎

## Appendix B Proofs for 3

### B.1 Proof of 1

By the support constraint, our cost \|x-y\|^{p} is pd^{(p-1)/2}-Lipschitz over \cX\times\cY. Thus, by Theorem 1 of Genevay et al. [2019], we have

|  |  |  |
| --- | --- | --- |
|  | S\_{p,\tau}(\hat{\mu}\_{n},\hat{\nu}\_{n})\leq\Wp(\hat{\mu}\_{n},\hat{\nu}\_{n})^{p% }+2\tau d\log\bigl{(}e^{2}pd^{p/2-1}\tau^{-1}\bigr{)}. |  |

Since \hat{\pi}\_{\tau,n} achieves the left hand side above and KL divergence is non-negative, we have

|  |  |  |
| --- | --- | --- |
|  | \iint\|x-y\|^{p}\dd\hat{\kappa}\_{n}(y|x)\dd\hat{\mu}\_{n}(x)\leq\Wp(\hat{\mu}\_{% n},\hat{\nu}\_{n})^{p}+2\tau d\log\bigl{(}e^{2}pd^{p/2-1}\tau^{-1}\bigr{)}. |  |

Taking pth roots and noting that (\hat{\kappa}\_{n})\_{\sharp}\hat{\mu}\_{n}=\hat{\nu}\_{n}, this implies that

|  |  |  |
| --- | --- | --- |
|  | \cE\_{p}(\hat{\kappa}\_{n};\hat{\mu}\_{n},\hat{\nu}\_{n})\leq\left[2\tau d\log% \bigl{(}e^{2}pd^{p/2-1}\tau^{-1}\bigr{)}\right]^{\frac{1}{p}}\leq 4(\tau d)^{% \frac{1}{p}}\log(e^{2}d\tau^{-1}). |  |

Now, by (7), (\hat{\kappa}\_{n})\_{x} is obtained by applying softmax to v(x)\defeq\bigl{(}(g\_{\tau}(Y\_{i})-\|x-Y\_{i}\|^{p})/\tau\bigr{)}\_{i=1}^{n}\in%
\R^{n}. Since the \ell\_{1},\ell\_{\infty} Lipschitz constant of the softmax operation is \leq 1, we have

|  |  |  |
| --- | --- | --- |
|  | \|(\hat{\kappa}\_{n})\_{x}-(\hat{\kappa}\_{n})\_{x^{\prime}}\|\_{\tv}\leq\frac{1}{2% }\|v(x)-v(x^{\prime})\|\_{\infty}\leq\frac{1}{2}pd^{(p-1)/2}\tau^{-1}\|x-x^{% \prime}\|\_{2} |  |

for all x,x^{\prime}\in[0,1]^{d}. Thus, by 1, \hat{\kappa}\_{n} is Hölder continuous under \Wp with exponent 1/p and constant 2\sqrt{d}\tau^{-1/p}. Applying 4 now gives