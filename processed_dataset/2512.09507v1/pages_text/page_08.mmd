Lemma 3.3 shows that to prove amenability of a discrete p.m.p. groupoid (\mathcal{G},\mu) it suffices to construct a [\mathcal{G}]-invariant mean on L^{\infty}(\mathcal{G},\mu\_{t}). In the context of Theorem B we achieve this by producing \Gamma-invariant means for arbitrary countable subgroups \Gamma\leq[\mathcal{G}], and then applying a compactness argument based on the weak{}^{\*}-topology. This strategy is heavily inspired by Hayes’ approach in [Ha24].

The following proposition states a classical characterization of amenability which we will use in the “only if” direction of the proof of Theorem B, often referred to as the *weak Godement condition*; see, for example, [Ana11, Definition 7.1].

###### Proposition 3.4.

A discrete measured groupoid (\mathcal{G},\mu) is amenable if and only if there exists a sequence (\xi\_{n})\_{n\in\mathbb{N}} of Borel functions on \mathcal{G} such that:

1. (i)

   \sum\_{g\in\mathcal{G}\_{x}}|\xi\_{n}(g)|^{2}=1 for \mu-almost every x\in\mathcal{G}^{(0)} and every n\in\mathbb{N};
2. (ii)

   F\_{n}\to 1 in the weak{}^{\ast}-topology on L^{\infty}(\mathcal{G},\mu\_{t})\cong L^{1}(\mathcal{G},\mu\_{t})^{\ast}, where F\_{n}\in L^{\infty}(\mathcal{G},\mu\_{t}) is given by F\_{n}(h):=\sum\_{g\in\mathcal{G}\_{t(h)}}\xi\_{n}(gh)\,\overline{\xi\_{n}(g)} for h\in\mathcal{G}.

### 3.3. Proof of Kesten’s criterion for amenability

We now work with Markov operators on restrictions of groupoids. For a discrete p.m.p. groupoid (\mathcal{G},\mu), an invariant Borel subset E\subseteq\mathcal{G}^{(0)} with \mu(E)>0, and a Borel function \pi\colon\mathcal{G}\to\mathbb{C} with \|\pi\|\_{I}<\infty, we denote by P\_{E}^{\pi}\in\mathbb{B}(L^{2}(\mathcal{G}|\_{E},(\mu\_{E})\_{t})) the Markov operator associated with (\mathcal{G}|\_{E},\mu\_{E}) and the restriction \pi|\_{\mathcal{G}|\_{E}}.

Definition A can then be formulated as follows.

###### Definition 3.5.

Let (\mathcal{G},\mu) be a discrete p.m.p. groupoid. We say that (\mathcal{G},\mu) satisfies *Kesten’s criterion* if, for every invariant Borel subset E\subseteq\mathcal{G}^{(0)} with \mu(E)>0 and every symmetric Borel field of probability measures \pi\colon\mathcal{G}\to\mathbb{C}, one has \|P\_{E}^{\pi}\|=1.

In the next lemma, a countable subgroup \Gamma\leq[\mathcal{G}] is said to *cover* \mathcal{G} if the union \bigcup\_{\gamma\in\Gamma}\gamma is a co-null set in \mathcal{G}.

###### Lemma 3.6.

Let (\mathcal{G},\mu) be a discrete p.m.p. groupoid such that \|P\_{E}^{\pi}\|=1 for every invariant Borel subset E\subseteq\mathcal{G}^{(0)} with \mu(E)>0 and every symmetric field \pi\colon\mathcal{G}\to\mathbb{C} of probability measures. Then for any invariant Borel subsets E\_{1},\ldots,E\_{k}\subseteq\mathcal{G}^{(0)} of positive measure and any countable subgroup \Gamma\leq[\mathcal{G}] covering \mathcal{G}, there exists a \Gamma-invariant mean m\in L^{\infty}(\mathcal{G},\mu)^{\ast} satisfying m(\chi\_{E\_{i}})=\mu(E\_{i}) for 1\leq i\leq k.

###### Proof.