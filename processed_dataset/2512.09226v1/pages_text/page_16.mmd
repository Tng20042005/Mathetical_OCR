|  |  |  |
| --- | --- | --- |
|  | d\_{{}^{r}/\Lambda}(Ag\_{1}+\Lambda,Ag\_{2}+\Lambda)\leq d\_{word}(g\_{1},g\_{2})% \leq\sqrt{r}\;d\_{{}^{r}/\Lambda}(Ag\_{1}+\Lambda,Ag\_{2}+\Lambda). |  |

By Theorem 5.8 in Khot-Naor [24],
any flat torus ({}^{r}/\Lambda,d\_{{}^{r}/\Lambda}) embeds into L\_{2} with distortion O(r^{3r/2}). (Remark: the dependence on r was recently improved by Haviv-Regev to r\sqrt{\log r} [19]).
Say the map f:{}^{r}/\Lambda\to L\_{2} achieves this distortion bound.
Then the map

|  |  |  |
| --- | --- | --- |
|  | G\to L\_{2}:y\mapsto f(Ay+\Lambda) |  |

is an embedding of distortion O\_{r}(1), where the distortion does NOT depend on G, nor on the generators s\_{1},...,s\_{r}.
  
CASE 2: Passing to finite extensions
  
We will essentially replicate the proof of the Milnor–Schwarz lemma (see [15] for instance), and observe that all the involved constants can be bounded by some function of [G:H] (and hence are independent of G and of the generators s\_{1},...,s\_{r}).

The Schreier graph \Gamma(G/H,S) is connected and has [G:H]-many points, hence its diameter at most [G:H].
This means that we may pick representatives for each coset k\_{1},...,k\_{J} (where J=[G:H]) such that

|  |  |  |
| --- | --- | --- |
|  | |k\_{i}|\_{T}\leq[G:H]\;\;\;and\;\;\cup\_{j=1}^{J}k\_{j}H=G. |  |

Consider the following subset of H:

|  |  |  |
| --- | --- | --- |
|  | T^{\prime}:=H\cap\{k\_{j\_{1}}^{-1}s\_{i}k\_{j\_{2}}:\;j\_{1},j\_{2}\in[J]\;\;and\;\;% i\in[r]\}. |  |

We claim that T^{\prime} generates H and moreover, the word metric of T^{\prime} is ”undistorted” with respect to the word metric of T:

|  |  |  |
| --- | --- | --- |
|  | |h|\_{T^{\prime}}\leq|h|\_{T}\leq(2[G:H]+1)|h|\_{T^{\prime}}\;\;\;for\;all\;h\in H. |  |

Fix any geodesic of length M\in\mathbb{N} from 1 to h\in H with generators in T,

|  |  |  |
| --- | --- | --- |
|  | 1\to g\_{1}\to g\_{2}\to...\to g\_{M}=h |  |

so g\_{m+1}g\_{m}^{-1}=s\_{i\_{m}} for some i\_{m}\in[r].
We may express via coset representatives g\_{m}=k\_{j\_{m}}h\_{m} where h\_{m}\in H and j\_{m}\in[J].
Now we have for each m\in[M]:

|  |  |  |
| --- | --- | --- |
|  | h\_{m+1}=k\_{j\_{m+1}}^{-1}s\_{i}k\_{j\_{m}}h\_{m}. |  |

This means that k\_{j\_{m+1}}^{-1}s\_{i}k\_{j\_{m}}\in H and moreover the path

|  |  |  |
| --- | --- | --- |
|  | 1\to h\_{1}\to h\_{2}\to...\to h\_{M}=h |  |

is a path from 1 to h in the Cayley graph of H generated by T^{\prime}.
This shows that <T^{\prime}>=H and moreover, |h|\_{T^{\prime}}\leq|h|\_{T}.
On the other hand, since |k\_{j\_{1}}^{-1}x\_{i}k\_{j\_{2}}|\_{T}\leq 2[G:H]+1, we get that:

|  |  |  |
| --- | --- | --- |
|  | |h|\_{T^{\prime}}\leq|h|\_{T}\leq(2[G:H]+1)|h|\_{T^{\prime}}\;\;\;for\;all\;h\in H. |  |